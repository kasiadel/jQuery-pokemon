var pokemonRepository = (function() {
	var t = [],
		e = 'https://pokeapi.co/api/v2/pokemon/?limit=150',
		n = $('.pokemon-list');
	function o(e) {
		t.push(e);
	}
	return (
		$(document).ready(function() {
			$('#search').on('keyup', function() {
				var t = $(this)
					.val()
					.toLowerCase();
				$('.btn-primary').filter(function() {
					$(this).toggle(
						$(this)
							.text()
							.toLowerCase()
							.indexOf(t) > -1
					);
				});
			});
		}),
		{
			add: o,
			getAll: function() {
				return t;
			},
			addListItem: function(t) {
				var e = $(
					'<button type="button" class="btn btn-primary btn-lg btn-block"  data-toggle="modal" data-target="#pokemon-modal"></button>'
				);
				e.text(t.name),
					n.append(e),
					e.on('click', function() {
						!(function(t) {
							pokemonRepository.loadDetails(t).then(function() {
								var e = $('.modal-body'),
									n =
										($('.modal-title').text(t.name),
										$('<p class="pokemonHeight"></p>').text(
											`Height: ${t.height} m`
										)),
									o = $('<p class="pokemonWeight"></p>').text(
										`Weight:  ${t.weight} kg`
									),
									a = $('<p class="pokemonTypes"></p>').text(
										`Types:  ${t.types}`
									),
									i = $('<img class="pokemonImage">');
								i.attr('src', t.imageUrl),
									e.children().length && e.children().remove(),
									e.append(i),
									e.append(n),
									e.append(o),
									e.append(a);
							});
						})(t);
					});
			},
			loadList: function() {
				return $.ajax(e, { dataType: 'json' })
					.then(function(t) {
						return t;
					})
					.then(function(t) {
						t.results.forEach(function(t) {
							o({ name: t.name, detailsUrl: t.url });
						});
					})
					.catch(function(t) {
						console.error(t);
					});
			},
			loadDetails: function(t) {
				var e = t.detailsUrl;
				return $.ajax(e, { dataType: 'json' })
					.then(function(t) {
						return t;
					})
					.then(function(e) {
						(t.imageUrl = e.sprites.front_default),
							(t.height = e.height),
							(t.weight = e.weight),
							2 == e.types.length
								? (t.types = [e.types[0].type.name, e.types[1].type.name])
								: (t.types = [e.types[0].type.name]);
					})
					.catch(function(t) {
						console.error(t);
					});
			}
		}
	);
})();
pokemonRepository.loadList().then(function() {
	pokemonRepository.getAll().forEach(function(t) {
		pokemonRepository.addListItem(t);
	});
});
